// javascript with php super variables
<script>
    window.onload = function(){
        var userFullName = function(){
            var result = null;
            var serverVarName = '<?php echo $_SERVER["SSL_CLIENT_S_DN_CN"]; ?>';
            var arrName = serverVarName.split(' ');
            result = arrName[1] + ' ' + arrName[0]; // John Doe
            return result;
        }(),
        userID = function(){
            var result = null;
            var serverVarName = '<?php echo $_SERVER["SSL_CLIENT_S_DN_CN"]; ?>';
            var arrName = serverVarName.split(' ');
            result = arrName[2];
            return result;
        }(),
        userID2 = function(){
            var result = null;
            var serverVarEmail = '<?php echo $_SERVER["SSL_CLIENT_SAN_Email_0"]; ?>';
            result = serverVarEmail.substr(0,serverVarEmail.indexOf('@'));
            return result;
        }(),
        userEmail = '<?php echo $_SERVER["SSL_CLIENT_SAN_Email_0"]; ?>;
        // create html elements;
        var divUser = document.createElement('DIV');
        var divUserFullName = document.createElement('DIV');
        var divUserID = document.createElement('DIV');
        var divUserID2 = document.createElement('DIV');
        var divUserEmail = document.createElement('DIV');
        var textUserFullName = document.createTextNode('Full Name: ' + userFullName);
        var textUserID = document.createTextNode('User ID: ' + userID);
        var textUserID2 = document.createTextNode('User ID2: ' + userID2);
        var textUserEmail = document.createTextNode('Email: ' + userEmail);
        
        divUserFullName.appendChild(textUserFullName);
        divUserID.appendChild(textUserID);
        divUserID2.appendChild(textUserID2);
        divUserEmail.appendChild(textUserEmail);
        divUser.appendChild(divUserFullName);
        divUser.appendChild(divUserID);
        divUser.appendChild(divUserID2);
        divUser.appendChild(divUserEmail);
        document.body.appendChild(divUser);
        
        console.log('userFullName: ' + userFullName);
        console.log('userID: ' + userID);
        console.log('userEmail: ' + userEmail);
        console.log('userID2: ' + userID2);
    }
</script>


// escaping apostrophes
foreach($_POST['tableUpdate'] as $key => $value) {
    $update .= "`" . $key . '` = "' . mysqli_real_escape_string($conn,$value) . '",' . ($i == count($_POST['tableUpdate']) ? ', ' : '');
    $i++;
}

// encrypting mysql connection
function OpenCon(){
    $servername = "server-name";
    $port = "3306";
    $username = "user-name";
    $password = "password1";
    $db = "db-name";
    
    $mysqli = mysqli_init();
    mysqli_options($mysqli, MYSQLI_OPT_SSL_VERIFY_SERVER_CERT, true);
    $mysqli->ssl_set(NULL,NULL,"path/to/cert.pem",NULL,NULL);
    $mysqli->real_connect($servername, $username, $password, $db, $port, NULL, MYSQLI_CLIENT_SSL);
    if (mysqli_connect_errno()) {
        die("Connection failed: " . $mysqli->connect_errno);
        echo ("failed to connect to the database");
    }
    return $mysqli;
}
function CloseCon($mysqli){
    $mysqli->close();
}